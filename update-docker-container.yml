---
- name: Update all docker compose images
  hosts: homelab

  vars_files:
    - compose-variables.yml
    - secure-variables.yml

  tasks:
    - name: Copy docker compose file.
      template:
        src: docker-compose.yml.j2
        dest: "{{ compose_install_dir }}/docker-compose.yml"

    - name: Pull latest images
      docker_compose:
        project_src: "{{ compose_install_dir }}"
        state: present
        pull: true
        recreate: smart
      become: yes